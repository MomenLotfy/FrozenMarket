<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ - ÙØ±ÙˆØ²Ù† Ù…Ø§Ø±ÙƒØª</title>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap.rtl.min.css" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
  <script type="module" src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.esm.js"></script>
  <script nomodule src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.js"></script>
    <link href="../css/style.css" rel="stylesheet">

  <style>
    

    body { 
      font-family: "Tajawal", "Segoe UI", sans-serif; 
      background: linear-gradient(135deg, var(--primary-blue) 0%, var(--primary-yellow) 100%); 
      min-height: 100vh; 
      display: flex; 
      align-items: center; 
      justify-content: center; 
      margin: 0; 
      padding: 15px;
      color: var(--text-dark);
      line-height: 1.6;
    }
    
    
  </style>
</head>
<body>
  <!-- Mobile Bottom Navigation -->
<div class="mobile-bottom-nav">
    <a href="#" id="openSidebar" class="bottom-nav-item">
        <ion-icon name="grid-outline"></ion-icon>
    </a>
    
   <a href="pages/Cart.html" class="bottom-nav-item position-relative">
    <ion-icon name="cart-outline"></ion-icon>
    <span id="mobile-cart-count" class="mobile-cart-count">0</span>
</a>

    
    <a href="index.html" class="bottom-nav-item active">
        <ion-icon name="home-outline"></ion-icon>
    </a>
    
    <a href="pages/wishlist.html" class="bottom-nav-item">
        <ion-icon name="heart-outline"></ion-icon>
    </a>
    
    <a href="pages/signup&signup.html" class="bottom-nav-item">
        <ion-icon name="person-outline"></ion-icon>
    </a>
</div>



<!-- Sidebar (RTL) -->
<div id="sidebar" class="sidebar">
    <div class="sidebar-content">
        <h2 class="sidebar-title">Ø§Ù„Ø£Ù‚Ø³Ø§Ù…</h2>
        <nav class="sidebar-links">
            <a href="pages/products.html#honey"><i class="fas fa-jar"></i> Ø§Ù„Ø¹Ø³Ù„</a>
            <a href="pages/products.html#butter"><i class="fas fa-cheese"></i> Ø§Ù„Ø²Ø¨Ø¯Ø©</a>
            <a href="pages/products.html#mozzarella"><i class="fas fa-pizza-slice"></i> Ø§Ù„Ù…ÙˆØªØ²Ø§Ø±ÙŠÙ„Ø§</a>
            <a href="pages/products.html#nuts"><i class="fas fa-seedling"></i> Ø§Ù„Ù…ÙƒØ³Ø±Ø§Øª</a>
            <a href="pages/products.html#chicken"><i class="fas fa-drumstick-bite"></i> Ø§Ù„ÙØ±Ø§Ø®</a>
            <a href="pages/products.html#meat"><i class="fas fa-hotdog"></i> Ø§Ù„Ù„Ø­ÙˆÙ…</a>
            <a href="pages/products.html#fish"><i class="fas fa-fish"></i> Ø§Ù„Ø£Ø³Ù…Ø§Ùƒ</a>
        </nav>

        <div class="sidebar-text">
            <h3>ÙØ±ÙˆØ²Ù† Ù…Ø§Ø±ÙƒØª</h3>
            <p>Ù†Ø³Ø¹Ù‰ Ù„ØªÙ‚Ø¯ÙŠÙ… Ø£ÙØ¶Ù„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„Ø·Ø§Ø²Ø¬Ø© ÙˆØ§Ù„Ø¹Ø§Ù„ÙŠØ© Ø§Ù„Ø¬ÙˆØ¯Ø© Ù„Ø¹Ù…Ù„Ø§Ø¦Ù†Ø§ Ø§Ù„ÙƒØ±Ø§Ù… Ø¨Ø£Ø³Ø¹Ø§Ø± Ù…Ù†Ø§Ø³Ø¨Ø© ÙˆØ®Ø¯Ù…Ø© Ù…ØªÙ…ÙŠØ²Ø©.</p>
        </div>

        <div class="sidebar-social">
            <p>ØªØ§Ø¨Ø¹Ù†Ø§</p>
            <a href="https://www.facebook.com/share/1CBX1XvNHf/" class="facebook" title="ÙÙŠØ³Ø¨ÙˆÙƒ">
                            <i class="fab fa-facebook-f"></i>
                        </a>
                        <a href="https://wa.me/201008064581" class="whatsapp" title="ÙˆØ§ØªØ³Ø§Ø¨">
                            <i class="fab fa-whatsapp"></i>
                        </a>
        </div>
    </div>
</div>

<!-- Overlay -->
<div id="overlay" class="overlay"></div>



<div class="auth-container">
  <div class="auth-header">
    <h3>ÙØ±ÙˆØ²Ù† Ù…Ø§Ø±ÙƒØª</h3>
    <p>Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ! Ù…Ù† ÙØ¶Ù„Ùƒ Ù‚Ù… Ø¨ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£Ùˆ Ø£Ù†Ø´Ø¦ Ø­Ø³Ø§Ø¨ Ø¬Ø¯ÙŠØ¯</p>
  </div>

  <!-- ØªØ­Ø°ÙŠØ± ÙˆØ¶Ø¹ Ø§Ù„Ù…Ø­Ø§ÙƒØ§Ø© -->
  <div id="emulatorWarning" class="firebase-emulator-warning hidden">
    <i class="fas fa-exclamation-triangle"></i>
    <span>ÙˆØ¶Ø¹ Ø§Ù„Ù…Ø­Ø§ÙƒØ§Ø© Ù…ÙØ¹Ù„ - Ù„Ù„ØªØ¬Ø±Ø¨Ø© ÙÙ‚Ø·</span>
  </div>

  <!-- Tabs -->
  <ul class="nav nav-tabs" id="authTabs" role="tablist">
    <li class="nav-item"><button class="nav-link active" id="signin-tab" data-bs-toggle="tab" data-bs-target="#signin">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</button></li>
    <li class="nav-item"><button class="nav-link" id="signup-tab" data-bs-toggle="tab" data-bs-target="#signup">Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨</button></li>
  </ul>

  <!-- Forms -->
  <div class="tab-content">
    <!-- Sign In -->
    <div class="tab-pane fade show active" id="signin">
      <form id="signin-form">
        <div class="input-group">
          <i class="fa fa-envelope input-icon"></i>
          <input type="email" class="form-control" id="loginEmail" placeholder="Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ" required>
        </div>
        <div class="input-group">
          <i class="fa fa-lock input-icon"></i>
          <input type="password" class="form-control" id="loginPassword" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±" required>
        </div>
        <div class="d-flex justify-content-between mb-3">
          <div class="form-check">
            <input type="checkbox" class="form-check-input" id="remember">
            <label class="form-check-label" for="remember">ØªØ°ÙƒØ±Ù†ÙŠ</label>
          </div>
          <a href="#" id="forgot-password" class="text-warning">Ù†Ø³ÙŠØª ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±ØŸ</a>
        </div>
        <button type="submit" class="btn btn-primary-custom w-100" id="loginBtn">
          ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
        </button>
        <div id="loginMsg"></div>
      </form>
    </div>

    <!-- Sign Up -->
    <div class="tab-pane fade" id="signup">
      <form id="registerForm">
        <div class="input-group">
          <i class="fa fa-user input-icon"></i>
          <input id="regName" type="text" class="form-control" placeholder="Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„" required>
        </div>
        <div class="input-group">
          <i class="fa fa-envelope input-icon"></i>
          <input id="regEmail" type="email" class="form-control" placeholder="Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ" required>
        </div>
        <div class="password-strength" id="passwordStrength"></div>
        <div class="input-group">
          <i class="fa fa-lock input-icon"></i>
          <input id="regPassword" type="password" class="form-control" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± (6 Ø£Ø­Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„)" required minlength="6">
        </div>

        <div class="input-group">
          <i class="fa fa-phone input-icon"></i>
          <input id="regPhone" type="tel" class="form-control" placeholder="Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ">
        </div>
        <div class="form-check mb-3">
          <input type="checkbox" class="form-check-input" id="agreeTerms" required>
          <label class="form-check-label" for="agreeTerms">
            Ø£ÙˆØ§ÙÙ‚ Ø¹Ù„Ù‰ <a href="#" class="text-warning">Ø§Ù„Ø´Ø±ÙˆØ· ÙˆØ§Ù„Ø£Ø­ÙƒØ§Ù…</a>
          </label>
        </div>
        <button type="submit" class="btn btn-primary-custom w-100" id="registerBtn">
          Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨
        </button>
        <div id="regMsg"></div>
      </form>
    </div>
  </div>


  <!-- Social Login -->
  <div class="social-login">
    <button class="btn-google" id="googleLoginBtn">
      <i class="fab fa-google"></i> 
      <span>Google</span>
    </button>
    <button class="btn-facebook" id="facebookLoginBtn">
      <i class="fab fa-facebook-f"></i> 
      <span>Facebook</span>
    </button>
  </div>

  <!-- Footer -->
  <div class="auth-footer">
    <p id="authFooterText">Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ Ø­Ø³Ø§Ø¨ØŸ <a href="#" onclick="document.getElementById('signup-tab').click()">Ø³Ø¬Ù„ Ø§Ù„Ø¢Ù†</a></p>
  </div>

  <div class="auth-footer mt-3">
  <button id="backBtn" class="btn btn-outline-light w-100">
    <i class="fa fa-arrow-right"></i> Ø±Ø¬ÙˆØ¹
  </button>
</div>


<!-- Bootstrap JS -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>

<script>
document.addEventListener("DOMContentLoaded", function () {
  const sidebar = document.getElementById("sidebar");
  const overlay = document.getElementById("overlay");
  const openBtn = document.getElementById("openSidebar");
  const links   = document.querySelectorAll("#sidebar .sidebar-links a");

  // ÙØªØ­
  openBtn.addEventListener("click", function (e) {
    e.preventDefault();
    sidebar.classList.add("active");
    overlay.classList.add("active");
  });

  // ØºÙ„Ù‚
  function closeSidebar() {
    sidebar.classList.remove("active");
    overlay.classList.remove("active");
  }

  overlay.addEventListener("click", closeSidebar);

  // ØºÙ„Ù‚ Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Ø£ÙŠ Ù„ÙŠÙ†Ùƒ
  links.forEach(link => {
    link.addEventListener("click", () => {
      closeSidebar();
    });
  });
});
</script>

<script>
  // Ø²Ø± Ø§Ù„Ø±Ø¬ÙˆØ¹ Ø§Ù„Ø°ÙƒÙŠ
const backBtn = document.getElementById('backBtn');
if (backBtn) {
  backBtn.addEventListener('click', () => {
    const urlParams = new URLSearchParams(window.location.search);
    const from = urlParams.get('from');

    if (from === 'products') {
      window.location.href = "products.html"; // Ø¹Ø¯Ù„Ù‡Ø§ Ø­Ø³Ø¨ Ø§Ø³Ù… Ù…Ù„Ù Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø¹Ù†Ø¯Ùƒ
    } else if (from === 'home') {
      window.location.href = "index.html"; // Ø¹Ø¯Ù„Ù‡Ø§ Ø­Ø³Ø¨ Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© Ø¹Ù†Ø¯Ùƒ
    } else {
      // fallback Ù„Ùˆ Ù…Ø´ Ø¬Ø§ÙŠ Ù…Ù† Ø­Ø§Ø¬Ø© Ù…Ø¹ÙŠÙ†Ø©
      window.history.back();
    }
  });
}

</script>

<!-- Firebase -->
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-app.js";
  import { 
    getAuth, 
    createUserWithEmailAndPassword, 
    signInWithEmailAndPassword, 
    GoogleAuthProvider, 
    FacebookAuthProvider, 
    signInWithPopup,
    signInWithRedirect,
    getRedirectResult,
    sendPasswordResetEmail,
    updateProfile,
    onAuthStateChanged,
    signOut,
    setPersistence,
    browserLocalPersistence,
    connectAuthEmulator
  } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-auth.js";
  import { 
    getFirestore, 
    doc, 
    setDoc, 
    getDoc,
    serverTimestamp,
    connectFirestoreEmulator 
  } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore.js";

  // âš ï¸ Ø§Ø³ØªØ¨Ø¯Ù„ Ù‡Ø°Ù‡ Ø§Ù„Ù‚ÙŠÙ… Ø¨Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ù…Ø´Ø±ÙˆØ¹Ùƒ Ù…Ù† Firebase Console
  const firebaseConfig = {
    apiKey: "AIzaSyCFk_WlW4qHcSbsLSHeWUTfGsc5W0FSE8A",
    authDomain: "frozenmarket-5c9df.firebaseapp.com",
    projectId: "frozenmarket-5c9df",
    storageBucket: "frozenmarket-5c9df.firebasestorage.app",
    messagingSenderId: "847658049541",
    appId: "1:847658049541:web:6f4cd551a12d5e45b5bc6c",
    measurementId: "G-32ZC3B3KPT"
  };

  // Initialize Firebase
  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);
  const db = getFirestore(app);

  // ØªÙØ¹ÙŠÙ„ ÙˆØ¶Ø¹ Ø§Ù„Ù…Ø­Ø§ÙƒØ§Ø© Ù„Ù„Ø§Ø®ØªØ¨Ø§Ø± (Ø¥Ù„ØºØ§Ø¡ Ø§Ù„ØªØ¹Ù„ÙŠÙ‚ Ø¹Ù†Ø¯ Ø§Ù„Ø­Ø§Ø¬Ø©)
  const useEmulator = false; // ØºÙŠØ± Ù‡Ø°Ù‡ Ø§Ù„Ù‚ÙŠÙ…Ø© Ø¥Ù„Ù‰ true Ù„ØªÙØ¹ÙŠÙ„ Ø§Ù„Ù…Ø­Ø§ÙƒØ§Ø©
  if (useEmulator && window.location.hostname === "localhost") {
    try {
      connectAuthEmulator(auth, "http://localhost:9099");
      connectFirestoreEmulator(db, "localhost", 8080);
      document.getElementById('emulatorWarning').classList.remove('hidden');
      console.log("ğŸ”¥ Firebase Emulator connected");
    } catch (error) {
      console.error("Failed to connect to emulator:", error);
    }
  }

  // ØªÙØ¹ÙŠÙ„ Local Persistence
  setPersistence(auth, browserLocalPersistence);

  // Ù…ØªØºÙŠØ±Ø§Øª Ù„Ù„ØªØ­ÙƒÙ… ÙÙŠ Ø§Ù„ØªØ¯ÙÙ‚
  let isProcessingAuth = false;
  let redirectInProgress = false;
  let isUserRedirected = false;

  // Ø¹Ù†Ø§ØµØ± DOM
  const loginForm = document.getElementById('signin-form');
  const registerForm = document.getElementById('registerForm');
  const googleBtn = document.getElementById('googleLoginBtn');
  const facebookBtn = document.getElementById('facebookLoginBtn');
  const forgotPasswordLink = document.getElementById('forgot-password');
  const currentUserInfo = document.getElementById('currentUserInfo');

  // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø±Ø³Ø§Ù„Ø© ØªØ³Ø¬ÙŠÙ„ Ø®Ø±ÙˆØ¬
  const urlParams = new URLSearchParams(window.location.search);
  if (urlParams.get('logout') === 'true') {
    showLogoutNotice();
    // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ù…Ø¹Ø§Ù…Ù„ Ù…Ù† URL
    window.history.replaceState({}, document.title, window.location.pathname);
  }

  // Ø¯Ø§Ù„Ø© Ø¹Ø±Ø¶ Ø¥Ø´Ø¹Ø§Ø± ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬
  function showLogoutNotice() {
    const notice = document.createElement('div');
    notice.className = 'logout-notice';
    notice.textContent = 'ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬ Ø¨Ù†Ø¬Ø§Ø­';
    document.body.appendChild(notice);
    
    setTimeout(() => {
      notice.remove();
    }, 3000);
  }

  // Ø¯Ø§Ù„Ø© Ù„Ø¹Ø±Ø¶ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„
  function showMessage(elementId, message, type = 'success') {
    const msgElement = document.getElementById(elementId);
    msgElement.textContent = message;
    msgElement.className = type === 'success' ? 'msg-success' : 'msg-error';
    
    if (type === 'error') {
      msgElement.parentElement.classList.add('shake');
      setTimeout(() => msgElement.parentElement.classList.remove('shake'), 600);
    }
    
    setTimeout(() => {
      msgElement.textContent = '';
      msgElement.className = '';
    }, 5000);
  }

  // Ø¯Ø§Ù„Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„
  function setLoading(buttonElement, isLoading) {
    if (isLoading) {
      buttonElement.disabled = true;
      const originalText = buttonElement.innerHTML;
      buttonElement.dataset.originalText = originalText;
      buttonElement.innerHTML = originalText + '<span class="spinner"></span>';
    } else {
      buttonElement.disabled = false;
      if (buttonElement.dataset.originalText) {
        buttonElement.innerHTML = buttonElement.dataset.originalText;
      }
    }
  }

  // Ø¯Ø§Ù„Ø© Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø§Ù„Ø¢Ù…Ù† Ù„Ù„Ø¨Ø±ÙˆÙØ§ÙŠÙ„
  function redirectToProfile() {
    if (redirectInProgress || isUserRedirected) return;
    redirectInProgress = true;
    isUserRedirected = true;
    
    sessionStorage.setItem('justLoggedIn', 'true');
    window.location.href = "ProfilePage.html";

  }

  // Ø¯Ø§Ù„Ø© Ø­ÙØ¸/ØªØ­Ø¯ÙŠØ« Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
  async function saveUserToFirestore(user, isNewUser = false, additionalData = {}) {
    try {
      const userDoc = doc(db, "users", user.uid);
      
      // Ø¥Ø°Ø§ ÙƒØ§Ù† Ù…Ø³ØªØ®Ø¯Ù… Ø¬Ø¯ÙŠØ¯ Ø£Ùˆ Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù„Ù‡ Ø¨ÙŠØ§Ù†Ø§Øª
      if (isNewUser) {
        const userData = {
          uid: user.uid,
          name: user.displayName || additionalData.name || "Ù…Ø³ØªØ®Ø¯Ù… Ø¬Ø¯ÙŠØ¯",
          email: user.email,
          phone: user.phoneNumber || additionalData.phone || "",
          photoURL: user.photoURL || "",
          role: "user",
          registerDate: new Date().toLocaleDateString('ar-EG'),
          createdAt: serverTimestamp(),
          lastLoginAt: serverTimestamp(),
          loginMethod: additionalData.loginMethod || "email",
          isEmailVerified: user.emailVerified,
          stats: {
            ordersCount: 0,
            totalSpent: 0,
            lastOrderAt: null
          },
          addresses: {
            primary: "",
            secondary: ""
          },
          preferences: {
            deliveryTime: "Ø£ÙŠ ÙˆÙ‚Øª",
            notifications: {
              email: true,
              sms: true,
              promotional: false,
              orderStatus: true
            }
          }
        };
        
        await setDoc(userDoc, userData);
        console.log("New user saved to Firestore");
      } else {
        // ØªØ­Ø¯ÙŠØ« Ø¢Ø®Ø± ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ ÙÙ‚Ø·
        await setDoc(userDoc, {
          lastLoginAt: serverTimestamp(),
          isEmailVerified: user.emailVerified
        }, { merge: true });
      }
    } catch (error) {
      console.error("Error saving user to Firestore:", error);
    }
  }

  // Ø¯Ø§Ù„Ø© Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙƒÙˆÙ† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¬Ø¯ÙŠØ¯
  async function isNewUser(user) {
    try {
      const userDoc = await getDoc(doc(db, "users", user.uid));
      return !userDoc.exists();
    } catch (error) {
      console.error("Error checking if user is new:", error);
      return true; // ÙÙŠ Ø­Ø§Ù„Ø© Ø§Ù„Ø®Ø·Ø£ØŒ Ù†Ø¹ØªØ¨Ø±Ù‡ Ù…Ø³ØªØ®Ø¯Ù… Ø¬Ø¯ÙŠØ¯
    }
  }

  // Ø¯Ø§Ù„Ø© Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø£Ø®Ø·Ø§Ø¡
  function getErrorMessage(errorCode, context = 'general') {
    const errorMessages = {
      // Ø£Ø®Ø·Ø§Ø¡ Ø¹Ø§Ù…Ø©
      'auth/network-request-failed': 'Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª',
      'auth/too-many-requests': 'Ù…Ø­Ø§ÙˆÙ„Ø§Øª ÙƒØ«ÙŠØ±Ø© Ø¬Ø¯Ø§Ù‹ØŒ Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰ Ù„Ø§Ø­Ù‚Ø§Ù‹',
      'auth/operation-not-allowed': 'Ù‡Ø°Ù‡ Ø§Ù„Ø¹Ù…Ù„ÙŠØ© ØºÙŠØ± Ù…Ø³Ù…ÙˆØ­Ø©',
      
      // Ø£Ø®Ø·Ø§Ø¡ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
      'auth/user-not-found': 'Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø­Ø³Ø§Ø¨ Ø¨Ù‡Ø°Ø§ Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ',
      'auth/wrong-password': 'ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± ØµØ­ÙŠØ­Ø©',
      'auth/invalid-email': 'Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ ØºÙŠØ± ØµØ­ÙŠØ­',
      'auth/user-disabled': 'Ù‡Ø°Ø§ Ø§Ù„Ø­Ø³Ø§Ø¨ Ù…Ø¹Ø·Ù„',
      'auth/invalid-credential': 'Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„ ØºÙŠØ± ØµØ­ÙŠØ­Ø©',
      
      // Ø£Ø®Ø·Ø§Ø¡ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ø³Ø§Ø¨
      'auth/email-already-in-use': 'Ù‡Ø°Ø§ Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ Ù…ÙØ³ØªØ®Ø¯Ù… Ø¨Ø§Ù„ÙØ¹Ù„',
      'auth/weak-password': 'ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø¶Ø¹ÙŠÙØ© (6 Ø£Ø­Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„)',
      
      // Ø£Ø®Ø·Ø§Ø¡ Social Login
      'auth/popup-blocked': 'ØªÙ… Ø­Ø¸Ø± Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø©ØŒ Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰',
      'auth/popup-closed-by-user': 'ØªÙ… Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø©',
      'auth/cancelled-popup-request': 'ØªÙ… Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©',
      'auth/account-exists-with-different-credential': 'ÙŠÙˆØ¬Ø¯ Ø­Ø³Ø§Ø¨ Ø¨Ù‡Ø°Ø§ Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø¨Ø·Ø±ÙŠÙ‚Ø© Ø¯Ø®ÙˆÙ„ Ù…Ø®ØªÙ„ÙØ©'
    };
    
    return errorMessages[errorCode] || 'Ø­Ø¯Ø« Ø®Ø·Ø£ ØºÙŠØ± Ù…ØªÙˆÙ‚Ø¹ØŒ Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰';
  }

  // Ø¯Ø§Ù„Ø© ØªÙ‚ÙŠÙŠÙ… Ù‚ÙˆØ© ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±
  function checkPasswordStrength(password) {
    const strengthIndicator = document.getElementById('passwordStrength');
    
    if (!password) {
      strengthIndicator.className = 'password-strength';
      return;
    }
    
    let strength = 0;
    
    if (password.length >= 6) strength++;
    if (password.length >= 8) strength++;
    if (/[A-Z]/.test(password)) strength++;
    if (/[0-9]/.test(password)) strength++;
    if (/[^A-Za-z0-9]/.test(password)) strength++;
    
    if (strength <= 2) {
      strengthIndicator.className = 'password-strength weak';
    } else if (strength <= 4) {
      strengthIndicator.className = 'password-strength medium';
    } else {
      strengthIndicator.className = 'password-strength strong';
    }
  }

  // Ø¯Ø§Ù„Ø© Ø¹Ø±Ø¶ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø­Ø§Ù„ÙŠ
  function showCurrentUserInfo(user) {
    document.getElementById('currentUserName').textContent = user.displayName || 'Ù…Ø³ØªØ®Ø¯Ù… Ù…Ø³Ø¬Ù„';
    document.getElementById('currentUserEmail').textContent = user.email;
    
    if (user.photoURL) {
      document.getElementById('currentUserAvatar').src = user.photoURL;
      document.getElementById('currentUserAvatar').style.display = 'block';
      document.getElementById('currentUserIcon').style.display = 'none';
    } else {
      document.getElementById('currentUserAvatar').style.display = 'none';
      document.getElementById('currentUserIcon').style.display = 'block';
    }
    
    currentUserInfo.style.display = 'block';
  }

  function hideCurrentUserInfo() {
    currentUserInfo.style.display = 'none';
  }

  // --- ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ ---
  loginForm.addEventListener('submit', async (e) => {
    e.preventDefault();
    if (isProcessingAuth) return;
    
    isProcessingAuth = true;
    setLoading(document.getElementById('loginBtn'), true);
    
    const email = document.getElementById('loginEmail').value.trim();
    const password = document.getElementById('loginPassword').value;
    
    if (!email || !password) {
      showMessage('loginMsg', 'ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„', 'error');
      isProcessingAuth = false;
      setLoading(document.getElementById('loginBtn'), false);
      return;
    }
    
    try {
      const userCredential = await signInWithEmailAndPassword(auth, email, password);
      const user = userCredential.user;
      
      // Ø­ÙØ¸/ØªØ­Ø¯ÙŠØ« Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
      const isNew = await isNewUser(user);
      await saveUserToFirestore(user, isNew, { loginMethod: 'email' });
      
      showMessage('loginMsg', 'ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ù†Ø¬Ø§Ø­! Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­ÙˆÙŠÙ„...', 'success');
      redirectToProfile();
      
    } catch (error) {
      console.error('Login error:', error);
      showMessage('loginMsg', getErrorMessage(error.code, 'login'), 'error');
      isProcessingAuth = false;
      setLoading(document.getElementById('loginBtn'), false);
    }
  });

  // --- Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨ Ø¬Ø¯ÙŠØ¯ ---
  registerForm.addEventListener('submit', async (e) => {
    e.preventDefault();
    if (isProcessingAuth) return;
    
    isProcessingAuth = true;
    setLoading(document.getElementById('registerBtn'), true);
    
    const name = document.getElementById('regName').value.trim();
    const email = document.getElementById('regEmail').value.trim();
    const password = document.getElementById('regPassword').value;
    const phone = document.getElementById('regPhone').value.trim();
    const agreeTerms = document.getElementById('agreeTerms').checked;
    
    if (!name || !email || !password) {
      showMessage('regMsg', 'ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©', 'error');
      isProcessingAuth = false;
      setLoading(document.getElementById('registerBtn'), false);
      return;
    }
    
    if (!agreeTerms) {
      showMessage('regMsg', 'ÙŠØ¬Ø¨ Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø´Ø±ÙˆØ· ÙˆØ§Ù„Ø£Ø­ÙƒØ§Ù…', 'error');
      isProcessingAuth = false;
      setLoading(document.getElementById('registerBtn'), false);
      return;
    }
    
    if (password.length < 6) {
      showMessage('regMsg', 'ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ÙŠØ¬Ø¨ Ø£Ù† ØªÙƒÙˆÙ† 6 Ø£Ø­Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„', 'error');
      isProcessingAuth = false;
      setLoading(document.getElementById('registerBtn'), false);
      return;
    }
    
    try {
      // Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
     // Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
const userCredential = await createUserWithEmailAndPassword(auth, email, password);
const user = userCredential.user;

// ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ
await updateProfile(user, { displayName: name });

// Ø­ÙØ¸ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… (Ù…Ø³ØªØ®Ø¯Ù… Ø¬Ø¯ÙŠØ¯) â† ÙÙŠ Ø§Ù„Ø®Ù„ÙÙŠØ©
saveUserToFirestore(user, true, { 
  name: name, 
  phone: phone, 
  loginMethod: 'email' 
}).catch(console.error); // Ø£ÙŠ Ø®Ø·Ø£ ÙŠØªØ³Ø¬Ù„ ÙÙŠ Ø§Ù„ÙƒÙˆÙ†Ø³ÙˆÙ„

// Ø­ÙˆÙ„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙÙˆØ±Ø§Ù‹
showMessage('regMsg', 'ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ø³Ø§Ø¨ Ø¨Ù†Ø¬Ø§Ø­! Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­ÙˆÙŠÙ„...', 'success');
redirectToProfile();

      
    } catch (error) {
      console.error('Registration error:', error);
      showMessage('regMsg', getErrorMessage(error.code, 'register'), 'error');
      isProcessingAuth = false;
      setLoading(document.getElementById('registerBtn'), false);
    }
  });

  // --- ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ù€ Google ---
  googleBtn.addEventListener('click', async () => {
    if (isProcessingAuth) return;
    
    isProcessingAuth = true;
    setLoading(googleBtn, true);
    
    const provider = new GoogleAuthProvider();
    provider.setCustomParameters({
      prompt: 'select_account'
    });
    
    try {
      let result;
      
      // Ù…Ø­Ø§ÙˆÙ„Ø© Ø§Ø³ØªØ®Ø¯Ø§Ù… Popup Ø£ÙˆÙ„Ø§Ù‹
      try {
        result = await signInWithPopup(auth, provider);
      } catch (popupError) {
        // Ø¥Ø°Ø§ ÙØ´Ù„ PopupØŒ Ø§Ø³ØªØ®Ø¯Ù… Redirect
        if (popupError.code === 'auth/popup-blocked' || 
            popupError.code === 'auth/popup-closed-by-user') {
          console.log('Popup blocked, using redirect...');
          await signInWithRedirect(auth, provider);
          return; // Ø§Ù„Ø®Ø±ÙˆØ¬ Ù„Ø£Ù† Ø§Ù„Ù€ redirect Ø³ÙŠØªÙ… Ø§Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹Ù‡ ÙÙŠ onAuthStateChanged
        }
        throw popupError;
      }
      
      // Ø¥Ø°Ø§ Ù†Ø¬Ø­ Popup
      const user = result.user;
      const isNew = await isNewUser(user);
      await saveUserToFirestore(user, isNew, { loginMethod: 'google' });
      
      showMessage('loginMsg', 'ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ù†Ø¬Ø§Ø­! Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­ÙˆÙŠÙ„...', 'success');
      redirectToProfile();
      
    } catch (error) {
      console.error('Google sign-in error:', error);
      showMessage('loginMsg', getErrorMessage(error.code, 'google'), 'error');
      isProcessingAuth = false;
      setLoading(googleBtn, false);
    }
  });

  // --- ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ù€ Facebook ---
  facebookBtn.addEventListener('click', async () => {
    if (isProcessingAuth) return;
    
    isProcessingAuth = true;
    setLoading(facebookBtn, true);
    
    const provider = new FacebookAuthProvider();
    provider.addScope('email');
    
    try {
      let result;
      
      // Ù…Ø­Ø§ÙˆÙ„Ø© Ø§Ø³ØªØ®Ø¯Ø§Ù… Popup Ø£ÙˆÙ„Ø§Ù‹
      try {
        result = await signInWithPopup(auth, provider);
      } catch (popupError) {
        // Ø¥Ø°Ø§ ÙØ´Ù„ PopupØŒ Ø§Ø³ØªØ®Ø¯Ù… Redirect
        if (popupError.code === 'auth/popup-blocked' || 
            popupError.code === 'auth/popup-closed-by-user') {
          console.log('Popup blocked, using redirect...');
          await signInWithRedirect(auth, provider);
          return; // Ø§Ù„Ø®Ø±ÙˆØ¬ Ù„Ø£Ù† Ø§Ù„Ù€ redirect Ø³ÙŠØªÙ… Ø§Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹Ù‡ ÙÙŠ onAuthStateChanged
        }
        throw popupError;
      }
      
      // Ø¥Ø°Ø§ Ù†Ø¬Ø­ Popup
      const user = result.user;
      const isNew = await isNewUser(user);
      await saveUserToFirestore(user, isNew, { loginMethod: 'facebook' });
      
      showMessage('loginMsg', 'ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ù†Ø¬Ø§Ø­! Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­ÙˆÙŠÙ„...', 'success');
      redirectToProfile();
      
    } catch (error) {
      console.error('Facebook sign-in error:', error);
      showMessage('loginMsg', getErrorMessage(error.code, 'facebook'), 'error');
      isProcessingAuth = false;
      setLoading(facebookBtn, false);
    }
  });

  // --- Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ---
  forgotPasswordLink.addEventListener('click', async (e) => {
    e.preventDefault();
    
    const email = document.getElementById('loginEmail').value.trim();
    if (!email) {
      showMessage('loginMsg', 'ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ Ø£ÙˆÙ„Ø§Ù‹', 'error');
      return;
    }
    
    try {
      await sendPasswordResetEmail(auth, email);
      showMessage('loginMsg', 'ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø±Ø§Ø¨Ø· Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø¥Ù„Ù‰ Ø¨Ø±ÙŠØ¯Ùƒ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ', 'success');
    } catch (error) {
      console.error('Password reset error:', error);
      showMessage('loginMsg', getErrorMessage(error.code, 'password-reset'), 'error');
    }
  });

  // --- Ù…Ø±Ø§Ù‚Ø¨Ø© Ø­Ø§Ù„Ø© Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø© ---
  onAuthStateChanged(auth, async (user) => {
    if (user) {
      // Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…Ø³Ø¬Ù„ Ø§Ù„Ø¯Ø®ÙˆÙ„
      console.log('User is signed in:', user);
      showCurrentUserInfo(user);
      
      // Ø¥Ø°Ø§ ÙƒØ§Ù† Ù‡Ø°Ø§ Ù†ØªÙŠØ¬Ø© redirect Ù…Ù† Social Login
      if (!isUserRedirected && !redirectInProgress) {
        const isNew = await isNewUser(user);
        await saveUserToFirestore(user, isNew, { 
          loginMethod: user.providerData[0]?.providerId || 'unknown' 
        });
        
        redirectToProfile();
      }
    } else {
      // Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ØºÙŠØ± Ù…Ø³Ø¬Ù„ Ø§Ù„Ø¯Ø®ÙˆÙ„
      console.log('User is signed out');
      hideCurrentUserInfo();
    }
    
    // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©
    isProcessingAuth = false;
    setLoading(document.getElementById('loginBtn'), false);
    setLoading(document.getElementById('registerBtn'), false);
    setLoading(googleBtn, false);
    setLoading(facebookBtn, false);
  });

  // --- Ù…Ø¹Ø§Ù„Ø¬Ø© Ù†ØªÙŠØ¬Ø© Ø§Ù„Ù€ Redirect (Ù„Ù€ Social Login) ---
  getRedirectResult(auth)
    .then((result) => {
      if (result) {
        console.log('Redirect result received:', result);
      }
    })
    .catch((error) => {
      console.error('Redirect result error:', error);
      showMessage('loginMsg', getErrorMessage(error.code, 'redirect'), 'error');
    });

  // --- Ø¯Ø§Ù„Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬ ---
  window.performLogout = async function() {
    try {
      await signOut(auth);
      showMessage('loginMsg', 'ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬ Ø¨Ù†Ø¬Ø§Ø­', 'success');
      hideCurrentUserInfo();
    } catch (error) {
      console.error('Logout error:', error);
      showMessage('loginMsg', 'Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬', 'error');
    }
  };

  // --- Ù…Ø±Ø§Ù‚Ø¨Ø© Ù‚ÙˆØ© ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„ÙƒØªØ§Ø¨Ø© ---
  document.getElementById('regPassword').addEventListener('input', (e) => {
    checkPasswordStrength(e.target.value);
  });

  // --- ØªØ­Ø¯ÙŠØ« Ù†Øµ Ø§Ù„ØªØ°ÙŠÙŠÙ„ Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„ØªØ¨ÙˆÙŠØ¨ Ø§Ù„Ù†Ø´Ø· ---
  document.querySelectorAll('#authTabs button').forEach(tab => {
    tab.addEventListener('click', () => {
      const authFooterText = document.getElementById('authFooterText');
      if (tab.id === 'signin-tab') {
        authFooterText.innerHTML = 'Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ Ø­Ø³Ø§Ø¨ØŸ <a href="#" onclick="document.getElementById(\'signup-tab\').click()">Ø³Ø¬Ù„ Ø§Ù„Ø¢Ù†</a>';
      } else {
        authFooterText.innerHTML = 'Ù„Ø¯ÙŠÙƒ Ø­Ø³Ø§Ø¨ Ø¨Ø§Ù„ÙØ¹Ù„ØŸ <a href="#" onclick="document.getElementById(\'signin-tab\').click()">Ø³Ø¬Ù„ Ø§Ù„Ø¯Ø®ÙˆÙ„</a>';
      }
    });
  });

  // --- Ù…Ù†Ø¹ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Enter ÙÙŠ Ø­Ù‚ÙˆÙ„ ØºÙŠØ± Ø²Ø± Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ ---
  document.querySelectorAll('input').forEach(input => {
    input.addEventListener('keypress', (e) => {
      if (e.key === 'Enter' && e.target.type !== 'submit') {
        e.preventDefault();
      }
    });
  });

  // --- Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø­ÙÙˆØ¸Ø© Ù„Ù„ØªØ°ÙƒØ± ---
  document.addEventListener('DOMContentLoaded', () => {
    const savedEmail = localStorage.getItem('rememberedEmail');
    if (savedEmail) {
      document.getElementById('loginEmail').value = savedEmail;
      document.getElementById('remember').checked = true;
    }
  });

  // --- Ø­ÙØ¸ Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ Ø¹Ù†Ø¯ ØªÙØ¹ÙŠÙ„ Ø§Ù„ØªØ°ÙƒØ± ---
  document.getElementById('remember').addEventListener('change', (e) => {
    const email = document.getElementById('loginEmail').value.trim();
    if (e.target.checked && email) {
      localStorage.setItem('rememberedEmail', email);
    } else {
      localStorage.removeItem('rememberedEmail');
    }
  });

  // --- Ø­ÙØ¸ Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ±Ù‡ Ù…Ø¹ ØªÙØ¹ÙŠÙ„ Ø§Ù„ØªØ°ÙƒØ± ---
  document.getElementById('loginEmail').addEventListener('blur', () => {
    if (document.getElementById('remember').checked) {
      const email = document.getElementById('loginEmail').value.trim();
      if (email) {
        localStorage.setItem('rememberedEmail', email);
      }
    }
  });

  // --- ØªÙ‡ÙŠØ¦Ø© Ø£ÙˆÙ„ÙŠØ© ---
  console.log("Firebase Auth initialized");
</script>

</body>
</html>
